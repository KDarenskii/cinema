"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[977],{6952:function(e,t,i){i.d(t,{Z:function(){return a}});i(2791);var n=i(1694),r=i.n(n),s=i(184),a=function(e){var t=e.title,i=e.overview,n=e.className;return(0,s.jsxs)("header",{className:r()("description-header",n),children:[(0,s.jsx)("h1",{className:"description-header__title",children:t}),i&&(0,s.jsx)("p",{className:"description-header__overview",children:i})]})}},3399:function(e,t,i){i.d(t,{Z:function(){return r}});i(2791);var n=i(184),r=function(e){var t=e.name,i=e.value;return(0,n.jsxs)("li",{className:"description-item",children:[(0,n.jsx)("div",{className:"description-item__name",children:t}),(0,n.jsx)("div",{className:"description-item__values-wrapper",children:Array.isArray(i)?i.map((function(e,t){return(0,n.jsx)("span",{className:"description-item__value",children:e},t)})):(0,n.jsx)("span",{className:"description-item__value",children:i})})]})}},5811:function(e,t,i){i.d(t,{Z:function(){return r}});i(2791);var n=i(184),r=function(e){var t=e.children,i=e.title;return(0,n.jsxs)("div",{className:"description-info",children:[(0,n.jsx)("h4",{className:"description-info__title",children:i}),(0,n.jsx)("ul",{className:"description-info__list",children:t})]})}},4814:function(e,t,i){i.d(t,{Z:function(){return a}});i(2791);var n=i(1694),r=i.n(n),s=i(184),a=function(e){var t=e.title,i=e.children,n=e.className;return(0,s.jsxs)("div",{className:r()("description-list",n),children:[(0,s.jsx)("h5",{className:"description-list__title",children:t}),(0,s.jsx)("ul",{className:"description-list__list",children:i})]})}},202:function(e,t,i){i.d(t,{Z:function(){return a}});i(2791);var n=i(1694),r=i.n(n),s=i(184),a=function(e){var t=e.src,i=e.className;return(0,s.jsx)("div",{className:r()("description-poster",i),children:(0,s.jsx)("img",{className:"description-poster__img",src:t,alt:"Poster"})})}},9694:function(e,t,i){i.r(t),i.d(t,{default:function(){return Ce}});var n,r,s=i(4165),a=i(5861),c=i(9439),l=i(2791),o=i(7689),u=i(2935),d=i(1087),m=i(7620),v=new Intl.NumberFormat(void 0,{style:"currency",currency:"USD",maximumFractionDigits:0,maximumSignificantDigits:3}).format,x=i(6952),h=i(5811),p=i(3399),f=i(4814),_=i(202),w=i(9331),j=i(1694),N=i.n(j),Z=i(3674),k=i(9026),g=i(1339),y=i(5212),A=i(6096),E=i(184),b=function(e){var t=e.cinema,i=e.className,n=l.useState(!1),r=(0,c.Z)(n,2),o=r[0],u=r[1],j=l.useState(null),b=(0,c.Z)(j,2),C=b[0],S=b[1],I=l.useState({}),T=(0,c.Z)(I,2),R=T[0],O=T[1],L=l.useState(!1),D=(0,c.Z)(L,2),B=D[0],V=D[1],P=l.useCallback((0,a.Z)((0,s.Z)().mark((function e(){var i,n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),S(null),e.prev=2,e.next=5,g.Z.fetchTrailerById(t.id);case 5:i=e.sent,O(i.data),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),r=e.t0,S(null!==(n=r.message)&&void 0!==n?n:null);case 13:return e.prev=13,u(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[2,9,13,16]])}))),[t.id]);return l.useEffect((function(){P()}),[P]),(0,E.jsxs)("section",{className:N()("cinema",i),children:[(0,E.jsxs)("div",{className:"cinema__intro",children:[(0,E.jsx)(_.Z,{className:"cinema__intro-poster",src:t.posterSrc}),C&&(0,E.jsx)(k.Z,{onClick:P,message:C}),o&&(0,E.jsx)(Z.Z,{className:"cinema__intro-loader"}),!C&&!o&&(0,E.jsx)(w.Z,{className:"cinema__intro-preview",onClick:function(){return V(!0)},preview:R})]}),(0,E.jsxs)("div",{className:"cinema__content",children:[(0,E.jsx)(x.Z,{className:"cinema__content-header",title:"".concat(t.title," (").concat(t.year,")"),overview:t.description}),(0,E.jsx)(_.Z,{className:"cinema__content-intro-poster",src:t.posterSrc}),(0,E.jsx)(y.Z,{className:"cinema__content-btn",onClick:function(){return V(!0)},children:"Watch film"}),(0,E.jsx)(A.Z,{channel:"youtube",youtube:{autoplay:1,mute:1},isOpen:B,videoId:t.videoId,onClose:function(){return V(!1)}}),(0,E.jsxs)("div",{className:"cinema__content-about",children:[(0,E.jsxs)(h.Z,{title:t.type===m.a.MOVIE?"About film":"About serial",children:[(0,E.jsx)(p.Z,{name:"Production year",value:t.year}),(0,E.jsx)(p.Z,{name:"Country",value:t.countries}),(0,E.jsx)(p.Z,{name:"Genre",value:t.genres}),(0,E.jsx)(p.Z,{name:"Director",value:t.directors}),(0,E.jsx)(p.Z,{name:"Screenwriter",value:t.screenwriters}),(0,E.jsx)(p.Z,{name:"Composer",value:t.composers}),(0,E.jsx)(p.Z,{name:"Budget",value:String(v(t.budget))}),(0,E.jsx)(p.Z,{name:"Profit",value:String(v(t.profit))}),(0,E.jsx)(p.Z,{name:"Age",value:t.age+"+"})]}),(0,E.jsx)(f.Z,{className:"cinema__content-about-list",title:"Lead roles",children:t.actors&&t.actors.map((function(e,t){return(0,E.jsx)(d.rU,{className:"cinema__content-about-link",to:"/cinema/actor/"+e.id,children:e.name},t)}))})]}),(0,E.jsxs)("div",{className:"cinema__content-story",children:[(0,E.jsx)("h4",{className:"cinema__content-story-title",children:"Short story"}),(0,E.jsx)("p",{className:"cinema__content-story-text",children:t.story})]}),(0,E.jsxs)("div",{className:"cinema__content-trailer",children:[C&&(0,E.jsx)(k.Z,{onClick:P,message:C}),o&&(0,E.jsx)(Z.Z,{className:"cinema__content-trailer-loader"}),!C&&!o&&(0,E.jsx)(w.Z,{className:"cinema__content-trailer-preview",onClick:function(){return V(!0)},preview:R})]})]})]})},C=i(2270),S=i(4942);!function(e){e.POSITIVE="positive",e.NEGATIVE="negative",e.NEUTRAL="neutral",e.NONE="none"}(r||(r={}));var I=(n={},(0,S.Z)(n,r.POSITIVE,"Positives"),(0,S.Z)(n,r.NEGATIVE,"Negatives"),(0,S.Z)(n,r.NEUTRAL,"Neutrals"),(0,S.Z)(n,r.NONE,"None"),n),T=i(1413),R=i(731),O=i(1472),L=i(5987),D=["className","children"],B=function(e){var t=e.className,i=e.children,n=(0,L.Z)(e,D);return(0,E.jsx)("select",(0,T.Z)((0,T.Z)({},n),{},{className:N()("select",t),children:i}))},V=i(2948),P=["className"],U=function(e){var t=e.className,i=(0,L.Z)(e,P);return(0,E.jsx)(V.Z,(0,T.Z)((0,T.Z)({},i),{},{className:N()("textarea",t)}))},G=i(5705),M=i(6727),F=M.Ry().shape({title:M.Z_().required("Title is required"),type:M.Z_().oneOf([r.NEGATIVE,r.NEUTRAL,r.POSITIVE],"Review type is required"),text:M.Z_().required("Text is required")}),Q=i(9911),q=i(4277),H=function(e){var t=e.preview,i=e.className,n=l.useState(!1),r=(0,c.Z)(n,2),s=r[0],a=r[1];return(0,E.jsxs)("article",{className:N()("review-preview","review-preview--".concat(t.type),i),children:[(0,E.jsx)("h4",{className:"review-preview__title",children:t.title}),(0,E.jsx)("div",{className:N()("review-preview__content",{"review-preview__content--full":s}),children:(0,E.jsx)("p",{className:"review-preview__text",children:t.text})}),(0,E.jsx)("button",{className:"review-preview__view-btn",onClick:function(){return a((function(e){return!e}))},children:s?"Show less":"Show full review"})]})},W=i(9829),z=i(8058),J=i(7443),K=i(8638),X=i(477),Y=i(9268),$=function(e){var t=e.id,i=e.className,n=e.setIsCreating,o=l.useState(!1),u=(0,c.Z)(o,2),d=u[0],m=u[1],v=(0,Q.T)(),x=(0,Y.C)(),h={type:r.NONE,title:"",text:""},p=function(){var e=(0,a.Z)((0,s.Z)().mark((function e(i){var r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,T.Z)((0,T.Z)({},i),{},{cinemaId:t,dislikesAmount:0,isDisliked:!1,isLiked:!1,likesAmount:0,id:(0,W.x0)(),date:(new Date).toISOString()}),e.prev=1,e.next=4,v((0,z.Z)(r)).unwrap();case 4:(0,J.M)(K.Q.SUCCESS,"Review created"),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),e.t0.isAuthError?x(X._e):(0,J.M)(K.Q.ERROR,"Failed to create review");case 11:return e.prev=11,n(!1),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[1,7,11,14]])})));return function(t){return e.apply(this,arguments)}}();return(0,E.jsx)(G.J9,{initialValues:h,onSubmit:p,validationSchema:F,children:function(e){var t=e.handleSubmit,n=e.handleChange,s=e.handleBlur,a=e.values,c=e.errors,l=e.touched,o=e.isSubmitting;return(0,E.jsxs)("div",{className:N()("review-creation",i),children:[d&&(0,E.jsx)(H,{className:"review-creation__preview",preview:a}),!d&&(0,E.jsxs)("form",{className:"review-creation__form",onSubmit:t,children:[(0,E.jsxs)("div",{className:"review-creation__form-item",children:[(0,E.jsxs)(B,{className:"review-creation__form-select",disabled:o,name:"type",onBlur:s,onChange:n,value:a.type,children:[(0,E.jsx)("option",{className:"review-creation__form-option",value:r.NONE,children:"Choose review type..."}),(0,E.jsx)("option",{className:"review-creation__form-option",value:r.POSITIVE,children:I.positive}),(0,E.jsx)("option",{className:"review-creation__form-option",value:r.NEGATIVE,children:I.negative}),(0,E.jsx)("option",{className:"review-creation__form-option",value:r.NEUTRAL,children:I.neutral})]}),c.type&&l.type&&(0,E.jsx)(q.Z,{className:"review-creation__form-error",message:c.type})]}),(0,E.jsxs)("div",{className:"review-creation__form-item",children:[(0,E.jsx)(O.Z,{className:"review-creation__form-input",disabled:o,placeholder:"Title",type:"text",name:"title",onBlur:s,onChange:n,value:a.title}),c.title&&l.title&&(0,E.jsx)(q.Z,{className:"review-creation__form-error",message:c.title})]}),(0,E.jsxs)("div",{className:"review-creation__form-item",children:[(0,E.jsx)(U,{className:"review-creation__form-textarea",name:"text",placeholder:"Text",disabled:o,onBlur:s,onChange:n,value:a.text}),c.text&&l.text&&(0,E.jsx)(q.Z,{className:"review-creation__form-error",message:c.text})]}),(0,E.jsx)(R.Z,{className:"review-creation__form-submit-btn",disabled:o,type:"submit",colorType:"success",children:"Publish review"})]}),(0,E.jsx)(y.Z,{className:"review-creation__preview-btn",onClick:function(){return m((function(e){return!e}))},type:"button",disabled:o||Boolean(!a.text||!a.title||a.type===r.NONE),children:d?"Back to editing":"Preview"})]})}})},ee=function(e){var t,i=e.text,n=e.type,r=(0,d.lr)(),s=(0,c.Z)(r,2),a=s[0],l=s[1];t=n?a.get("type")===n:!a.has("type");return(0,E.jsx)("div",{className:N()("reviews-count",{"reviews-count--active":t},n?"reviews-count--".concat(n):""),onClick:function(){n?a.set("type",n):a.delete("type"),l(a)},children:i})},te=i(3433),ie=i(4771),ne=i(9565),re=i(3186),se=function(e){return{list:e.reviews.list,error:e.reviews.error,isLoading:e.reviews.isLoading,amounts:{positives:e.reviews.list.filter((function(e){return e.type===r.POSITIVE})).length,negatives:e.reviews.list.filter((function(e){return e.type===r.NEGATIVE})).length,neutrals:e.reviews.list.filter((function(e){return e.type===r.NEUTRAL})).length,total:e.reviews.totalAmount}}},ae=i(9828),ce=i(7345),le=i(5655),oe=i(1363),ue=i(2645),de=function(e){var t=(0,Q.T)(),i=(0,Y.C)(),n=function(){var n=(0,a.Z)((0,s.Z)().mark((function n(){var r,a;return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=(0,T.Z)((0,T.Z)({},e),{},{isLiked:!e.isLiked,likesAmount:e.isLiked?e.likesAmount-1:e.likesAmount+1,isDisliked:!1,dislikesAmount:e.isDisliked?e.dislikesAmount-1:e.dislikesAmount}),n.prev=1,n.next=4,t((0,ue.r)(r)).unwrap();case 4:n.next=10;break;case 6:n.prev=6,n.t0=n.catch(1),(a=n.t0).isAuthError?i(X._e):(0,J.M)(K.Q.ERROR,a.message);case 10:case"end":return n.stop()}}),n,null,[[1,6]])})));return function(){return n.apply(this,arguments)}}();return(0,E.jsxs)(R.Z,{className:"review-like",onClick:n,colorType:"success",isActive:e.isLiked,children:[(0,E.jsx)(oe.G,{className:"review-like__icon",icon:["".concat(e.isLiked?"fas":"far"),"thumbs-up"]}),(0,E.jsx)("span",{className:"review-like__text",children:"Helpfull"}),(0,E.jsx)("span",{className:"review-like__amount",children:e.likesAmount})]})},me=function(e){var t=(0,Q.T)(),i=(0,Y.C)(),n=function(){var n=(0,a.Z)((0,s.Z)().mark((function n(){var r,a;return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=(0,T.Z)((0,T.Z)({},e),{},{isDisliked:!e.isDisliked,dislikesAmount:e.isDisliked?e.dislikesAmount-1:e.dislikesAmount+1,isLiked:!1,likesAmount:e.isLiked?e.likesAmount-1:e.likesAmount}),n.prev=1,n.next=4,t((0,ue.r)(r)).unwrap();case 4:n.next=10;break;case 6:n.prev=6,n.t0=n.catch(1),(a=n.t0).isAuthError?i(X._e):(0,J.M)(K.Q.ERROR,a.message);case 10:case"end":return n.stop()}}),n,null,[[1,6]])})));return function(){return n.apply(this,arguments)}}();return(0,E.jsxs)(R.Z,{className:"review-dislike",onClick:n,colorType:"error",isActive:e.isDisliked,children:[(0,E.jsx)(oe.G,{className:"review-dislike__icon",icon:["".concat(e.isDisliked?"fas":"far"),"thumbs-down"]}),(0,E.jsx)("span",{className:"review-dislike__text",children:"Not"}),(0,E.jsx)("span",{className:"review-dislike__amount",children:e.dislikesAmount})]})},ve=i(1874),xe=function(e){var t=e.id,i=(0,Q.T)(),n=(0,Y.C)(),r=function(){var e=(0,a.Z)((0,s.Z)().mark((function e(){var r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i((0,ve.i)(t)).unwrap();case 3:(0,J.M)(K.Q.SUCCESS,"Review was deleted"),e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),null!==(r=e.t0)&&void 0!==r&&r.isAuthError?n(X._e):(0,J.M)(K.Q.ERROR,r.message);case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}();return(0,E.jsxs)(R.Z,{className:"review-delete-btn",onClick:r,colorType:"error",children:[(0,E.jsx)(oe.G,{icon:"trash-alt"}),"Delete"]})},he=i(6638),pe=function(e){var t,i=e.children,n=e.roles,r=(0,he.a)(),s=r.isAuth,a=r.user,c=Boolean(null===a||void 0===a||null===(t=a.roles)||void 0===t?void 0:t.find((function(e){return n.includes(e)})));return(0,E.jsx)(E.Fragment,{children:s&&c?i:null})},fe=i(5194),_e=function(e){var t,i=l.useState(!1),n=(0,c.Z)(i,2),r=n[0],s=n[1],a=l.useRef(null);return(0,E.jsxs)("article",{className:N()("review","review--".concat(e.type)),children:[(0,E.jsx)("h4",{className:"review__title",children:e.title}),(0,E.jsx)("div",{className:N()("review__content",{"review__content--full":r}),children:(0,E.jsx)("p",{className:"review__text",ref:a,children:e.text})}),a.current&&(null===(t=a.current)||void 0===t?void 0:t.offsetHeight)>97&&(0,E.jsx)("button",{className:"review__view-btn",onClick:function(){return s((function(e){return!e}))},children:r?"Show less":"Show full review"}),(0,E.jsxs)("div",{className:"review__actions",children:[(0,E.jsx)(pe,{roles:[fe.p.ADMIN],children:(0,E.jsx)(xe,{id:e.id})}),(0,E.jsxs)("div",{className:"review__actions-wrapper",children:[(0,E.jsx)(de,(0,T.Z)({},e)),(0,E.jsx)(me,(0,T.Z)({},e))]})]})]})},we=i(8175),je=function(){return(0,E.jsxs)(we.ZP,{speed:2,width:600,height:265,viewBox:"0 0 600 265",backgroundColor:"#536593",foregroundColor:"#8280b7",children:[(0,E.jsx)("rect",{x:"20",y:"20",rx:"9",ry:"9",width:"150",height:"25"}),(0,E.jsx)("rect",{x:"20",y:"60",rx:"9",ry:"9",width:"560",height:"97"}),(0,E.jsx)("rect",{x:"20",y:"172",rx:"9",ry:"9",width:"106",height:"22"}),(0,E.jsx)("rect",{x:"480",y:"209",rx:"9",ry:"9",width:"100",height:"36"}),(0,E.jsx)("rect",{x:"334",y:"209",rx:"9",ry:"9",width:"136",height:"36"})]})},Ne=l.memo((function(e){var t=e.id,i=l.useState(1),n=(0,c.Z)(i,2),r=n[0],s=n[1],a=(0,d.lr)(),o=(0,c.Z)(a,1)[0],u=(0,ne.C)(se),m=u.isLoading,v=u.error,x=u.list,h=u.amounts,p=(0,Q.T)();return l.useEffect((function(){s(1),p((0,re.D)([]))}),[o,p]),l.useEffect((function(){p((0,ae.B)({cinemaId:t,type:o.get("type"),page:r}))}),[p,t,o,r]),(0,E.jsxs)(ie.Z,{next:function(){return s((function(e){return e+1}))},dataLength:x.length,hasMore:x.length<h.total,loader:m&&(0,E.jsx)(ce.Z,{}),style:{overflow:"initial"},endMessage:(0,E.jsx)(le.Z,{className:"movies-page__list-message",message:"There is no more content to show you ^_^"}),children:[(0,E.jsxs)("div",{className:"reviews__wrapper",children:[x.map((function(e){return(0,l.createElement)(_e,(0,T.Z)((0,T.Z)({},e),{},{key:e.id}))})),m&&(0,te.Z)(new Array(3)).map((function(e,t){return(0,E.jsx)(je,{},t)}))]}),v&&(0,E.jsx)(k.Z,{message:v,onClick:function(){return p((0,ae.B)({cinemaId:t,page:r}))}})]})})),Ze=function(e){var t=e.className,i=e.isCreating,n=e.setIsCreating,r=(0,he.a)().isAuth,s=(0,Y.C)();return(0,E.jsx)(E.Fragment,{children:!i&&(0,E.jsx)(E.Fragment,{children:(0,E.jsxs)(y.Z,{className:null!==t&&void 0!==t?t:"",onClick:function(){r?n(!0):s(X._e)},children:[" ","+ Write review"]})})})},ke=function(){var e=(0,o.UO)().id,t=void 0===e?"":e,i=l.useState(!1),n=(0,c.Z)(i,2),s=n[0],a=n[1];return(0,E.jsxs)("section",{className:"reviews",children:[(0,E.jsx)("h3",{className:"reviews__title",children:"Audience reviews"}),(0,E.jsx)(Ze,{className:"reviews__btn",isCreating:s,setIsCreating:a}),(0,E.jsxs)("div",{className:"reviews__content",children:[(0,E.jsxs)("div",{className:"reviews__inner",children:[s&&(0,E.jsx)($,{className:"reviews__creation",setIsCreating:a,id:t}),(0,E.jsx)(Ne,{id:t})]}),(0,E.jsxs)("div",{className:"reviews__info",children:[(0,E.jsx)(ee,{text:"All"}),(0,E.jsx)(ee,{text:I.positive,type:r.POSITIVE}),(0,E.jsx)(ee,{text:I.negative,type:r.NEGATIVE}),(0,E.jsx)(ee,{text:I.neutral,type:r.NEUTRAL})]})]})]})},ge=i(938),ye=i(3144),Ae=i(5671),Ee=i(1776),be=(0,ye.Z)((function e(){(0,Ae.Z)(this,e)}));be.fetchCinemaById=function(){var e=(0,a.Z)((0,s.Z)().mark((function e(t,i){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ee.h.get("cinemaDescriptions/"+t,i));case 1:case"end":return e.stop()}}),e)})));return function(t,i){return e.apply(this,arguments)}}();var Ce=function(){var e=(0,o.UO)().id,t=void 0===e?"":e,i=l.useState(!0),n=(0,c.Z)(i,2),r=n[0],d=n[1],m=l.useState(null),v=(0,c.Z)(m,2),x=v[0],h=v[1],p=l.useState({}),f=(0,c.Z)(p,2),_=f[0],w=f[1];return l.useEffect((function(){var e=function(){var e=(0,a.Z)((0,s.Z)().mark((function e(){var i,n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),h(null),e.prev=2,e.next=5,be.fetchCinemaById(t);case 5:i=e.sent,w(i.data),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),r=e.t0,h(null!==(n=r.message)&&void 0!==n?n:null);case 13:return e.prev=13,d(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[2,9,13,16]])})));return function(){return e.apply(this,arguments)}}();e()}),[t]),(0,E.jsxs)("div",{className:"cinema-page",children:[x&&(0,E.jsx)(u.Z,{type:ge.z.ERROR,message:x}),r&&(0,E.jsx)(C.Z,{}),!x&&!r&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(b,{className:"cinema-page__info",cinema:_}),(0,E.jsx)(ke,{})]})]})}}}]);
//# sourceMappingURL=Cinema.a006550a.chunk.js.map